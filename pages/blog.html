<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/png" sizes="16x16" href="../assets/img/Logo TF.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="../assets/img/Logo TF.png" />
    <link rel="icon" type="image/png" sizes="64x64" href="../assets/img/Logo TF.png" />
    <title>Blog - TitanFleet ERP</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link rel="stylesheet" href="../styles/styles.css" />
    <link rel="stylesheet" href="../styles/index.css" />
    <style>
      .blog-header {
        background: linear-gradient(135deg, #174d4d 0%, #2d7a7a 100%);
        color: white;
        padding: 80px 0 40px;
        margin-bottom: 40px;
      }
      .blog-post-card {
        transition:
          transform 0.3s,
          box-shadow 0.3s;
        margin-bottom: 30px;
        height: 100%;
      }
      .blog-post-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
      }
      .blog-post-meta {
        color: #6c757d;
        font-size: 0.9rem;
      }
      .blog-post-excerpt {
        color: #495057;
        line-height: 1.6;
      }
      .blog-actions {
        margin-top: 20px;
      }
      .btn-create-post {
        background: linear-gradient(135deg, #174d4d 0%, #2d7a7a 100%);
        border: none;
        color: white;
        padding: 12px 30px;
        font-weight: 600;
        border-radius: 5px;
        transition: all 0.3s;
      }
      .btn-create-post:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(23, 77, 77, 0.3);
        color: white;
      }
      .empty-state {
        text-align: center;
        padding: 60px 20px;
        color: #6c757d;
      }
      .empty-state i {
        font-size: 4rem;
        margin-bottom: 20px;
        opacity: 0.5;
      }
      .blog-tag {
        display: inline-block;
        padding: 4px 12px;
        background: #e9ecef;
        border-radius: 20px;
        font-size: 0.85rem;
        margin-right: 8px;
        margin-bottom: 8px;
      }
      .blog-tag.feature {
        background: #d4edda;
        color: #155724;
      }
      .blog-tag.update {
        background: #cce5ff;
        color: #004085;
      }
      .blog-tag.announcement {
        background: #fff3cd;
        color: #856404;
      }
    </style>
  </head>
  <body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg fixed-top">
      <div class="container">
        <a class="navbar-brand" href="../public/index.html">
          <img
            src="../assets/img/Logo TF color.png"
            alt="TitanFleet"
            style="height: 30px; width: auto; margin-right: 8px"
          />TitanFleet
        </a>

        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
        >
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav me-auto">
            <li class="nav-item">
              <a class="nav-link" href="../public/index.html">Inicio</a>
            </li>
            <li class="nav-item">
              <a class="nav-link active" href="blog.html">Blog</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="demo.html">Demo</a>
            </li>
          </ul>

          <div class="d-flex align-items-center gap-2">
            <button
              class="btn btn-primary"
              onclick="window.location.href='../public/index.html#contacto'"
            >
              <i class="fas fa-envelope me-1"></i>Contacto
            </button>
          </div>
        </div>
      </div>
    </nav>

    <!-- Blog Header -->
    <div class="blog-header">
      <div class="container">
        <div class="row align-items-center">
          <div class="col-md-8">
            <h1 class="display-4 fw-bold mb-3"><i class="fas fa-blog me-3"></i>Blog TitanFleet</h1>
            <p class="lead mb-0">
              Mantente al día con las últimas novedades, actualizaciones y mejoras de nuestra
              plataforma
            </p>
          </div>
          <div class="col-md-4 text-end">
            <button class="btn btn-light btn-lg btn-create-post" onclick="showCreatePostModal()">
              <i class="fas fa-plus-circle me-2"></i>Nueva Entrada
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Blog Content -->
    <div class="container">
      <!-- Loading State -->
      <div id="loadingState" class="text-center py-5">
        <div class="spinner-border text-primary" role="status">
          <span class="visually-hidden">Cargando...</span>
        </div>
        <p class="mt-3 text-muted">Cargando entradas del blog...</p>
      </div>

      <!-- Empty State -->
      <div id="emptyState" class="empty-state" style="display: none">
        <i class="fas fa-blog"></i>
        <h3>No hay entradas aún</h3>
        <p class="lead">Sé el primero en crear una entrada del blog</p>
        <button class="btn btn-primary btn-lg mt-3" onclick="showCreatePostModal()">
          <i class="fas fa-plus-circle me-2"></i>Crear Primera Entrada
        </button>
      </div>

      <!-- Blog Posts Grid -->
      <div id="blogPostsContainer" class="row" style="display: none">
        <!-- Las entradas se cargarán aquí dinámicamente -->
      </div>
    </div>

    <!-- Modal para Crear/Editar Entrada -->
    <div
      class="modal fade"
      id="postModal"
      tabindex="-1"
      aria-labelledby="postModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-lg modal-dialog-scrollable">
        <div class="modal-content">
          <div class="modal-header bg-primary text-white">
            <h5 class="modal-title" id="postModalLabel">
              <i class="fas fa-edit me-2"></i>Nueva Entrada del Blog
            </h5>
            <button
              type="button"
              class="btn-close btn-close-white"
              data-bs-dismiss="modal"
              aria-label="Cerrar"
            ></button>
          </div>
          <div class="modal-body">
            <form id="postForm">
              <div class="mb-3">
                <label for="postTitle" class="form-label fw-bold"
                  >Título <span class="text-danger">*</span></label
                >
                <input
                  type="text"
                  class="form-control"
                  id="postTitle"
                  required
                  placeholder="Ej: Nueva funcionalidad de reportes"
                />
              </div>

              <div class="mb-3">
                <label for="postCategory" class="form-label fw-bold">Categoría</label>
                <select class="form-select" id="postCategory">
                  <option value="feature">Nueva Funcionalidad</option>
                  <option value="update">Actualización</option>
                  <option value="announcement">Anuncio</option>
                  <option value="general">General</option>
                </select>
              </div>

              <div class="mb-3">
                <label for="postExcerpt" class="form-label fw-bold">Resumen</label>
                <textarea
                  class="form-control"
                  id="postExcerpt"
                  rows="2"
                  placeholder="Breve descripción que aparecerá en la lista de entradas"
                ></textarea>
              </div>

              <div class="mb-3">
                <label for="postContent" class="form-label fw-bold"
                  >Contenido <span class="text-danger">*</span></label
                >
                <textarea
                  class="form-control"
                  id="postContent"
                  rows="10"
                  required
                  placeholder="Escribe aquí el contenido completo de la entrada..."
                ></textarea>
                <small class="form-text text-muted"
                  >Puedes usar HTML básico para formatear el texto</small
                >
              </div>

              <div class="mb-3">
                <label for="postAuthor" class="form-label fw-bold">Autor</label>
                <input
                  type="text"
                  class="form-control"
                  id="postAuthor"
                  placeholder="Nombre del autor (opcional)"
                />
              </div>

              <div class="mb-3 form-check">
                <input type="checkbox" class="form-check-input" id="postPublished" checked />
                <label class="form-check-label" for="postPublished">
                  Publicar inmediatamente
                </label>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
              Cancelar
            </button>
            <button type="button" class="btn btn-primary" onclick="savePost()">
              <i class="fas fa-save me-2"></i>Guardar Entrada
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal para Ver Entrada Completa -->
    <div
      class="modal fade"
      id="viewPostModal"
      tabindex="-1"
      aria-labelledby="viewPostModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-lg modal-dialog-scrollable">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="viewPostModalTitle"></h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Cerrar"
            ></button>
          </div>
          <div class="modal-body" id="viewPostModalBody">
            <!-- Contenido se cargará dinámicamente -->
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
            <button type="button" class="btn btn-primary" id="btnEditPost" onclick="editPost()">
              <i class="fas fa-edit me-2"></i>Editar
            </button>
            <button type="button" class="btn btn-danger" id="btnDeletePost" onclick="deletePost()">
              <i class="fas fa-trash me-2"></i>Eliminar
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>
    <script type="module" src="../assets/scripts/firebase-init.js"></script>
    <script src="../assets/scripts/firebase-repo-base.js" defer></script>
    <script src="../assets/scripts/firebase-repos.js" defer></script>
    <script src="../assets/scripts/blog.js" defer></script>
  </body>
</html>
